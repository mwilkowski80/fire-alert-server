<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="470px" preserveAspectRatio="none" style="width:600px;height:470px;background:#FFFFFF;" version="1.1" viewBox="0 0 600 470" width="600px" zoomAndPan="magnify"><defs/><g><rect fill="#DDDDDD" height="458.9141" style="stroke:#181818;stroke-width:0.5;" width="211.5" x="1" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="112" x="50.75" y="18.0669">"IoT device" iot</text><rect fill="#FFFFFF" height="50.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="400" y="82.7266"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="56" x2="56" y1="72.7266" y2="414.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="164.5" x2="164.5" y1="72.7266" y2="414.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="277.5" x2="277.5" y1="72.7266" y2="414.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="404.5" x2="404.5" y1="72.7266" y2="414.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="545" x2="545" y1="72.7266" y2="414.3203"/><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103" x="5" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="17.5" y="45.1279">iot-fire-alert</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="12" y="61.4248">NodeMCU v2</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103" x="5" y="413.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="17.5" y="433.3154">iot-fire-alert</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="12" y="449.6123">NodeMCU v2</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="88" x="120.5" y="41.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="127.5" y="61.4248">PIR sensor</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="88" x="120.5" y="413.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="127.5" y="433.3154">PIR sensor</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="118" x="218.5" y="41.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104" x="225.5" y="61.4248">fire-alert-server</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="118" x="218.5" y="413.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104" x="225.5" y="433.3154">fire-alert-server</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="117" x="346.5" y="25.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="353.5" y="45.1279">Firebase Cloud</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="367.5" y="61.4248">Messaging</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="117" x="346.5" y="413.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="353.5" y="433.3154">Firebase Cloud</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="367.5" y="449.6123">Messaging</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="496" y="41.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="503" y="61.4248">Android App</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="496" y="413.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="503" y="433.3154">Android App</text><rect fill="#FFFFFF" height="50.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="400" y="82.7266"/><polygon fill="#181818" points="421,99.8594,411,103.8594,421,107.8594,417,103.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="415" x2="544" y1="103.8594" y2="103.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="427" y="98.7935">I need a token</text><polygon fill="#181818" points="533,128.9922,543,132.9922,533,136.9922,537,132.9922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="405" x2="539" y1="132.9922" y2="132.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="412" y="127.9263">This is Your token</text><polygon fill="#181818" points="288.5,173.2578,278.5,177.2578,288.5,181.2578,284.5,177.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="282.5" x2="544" y1="177.2578" y2="177.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="294.5" y="157.0591">This is my token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="294.5" y="172.1919">(HTTP protocol)</text><polygon fill="#181818" points="152.5,202.3906,162.5,206.3906,152.5,210.3906,156.5,206.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="56.5" x2="158.5" y1="206.3906" y2="206.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="63.5" y="201.3247">check sensor</text><polygon fill="#181818" points="67.5,216.3906,57.5,220.3906,67.5,224.3906,63.5,220.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="61.5" x2="163.5" y1="220.3906" y2="220.3906"/><polygon fill="#181818" points="152.5,245.5234,162.5,249.5234,152.5,253.5234,156.5,249.5234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="56.5" x2="158.5" y1="249.5234" y2="249.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="63.5" y="244.4575">check sensor</text><polygon fill="#181818" points="67.5,259.5234,57.5,263.5234,67.5,267.5234,63.5,263.5234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="61.5" x2="163.5" y1="263.5234" y2="263.5234"/><polygon fill="#181818" points="265.5,303.7891,275.5,307.7891,265.5,311.7891,269.5,307.7891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="56.5" x2="271.5" y1="307.7891" y2="307.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="63.5" y="287.5903">"I detected movement"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="63.5" y="302.7231">(UDP protocol)</text><polygon fill="#181818" points="393,363.1875,403,367.1875,393,371.1875,397,367.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="277.5" x2="399" y1="367.1875" y2="367.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="284.5" y="331.856">Push "fire alert"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70" x="284.5" y="346.9888">notification</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="284.5" y="362.1216">(using token)</text><polygon fill="#181818" points="533,392.3203,543,396.3203,533,400.3203,537,396.3203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="405" x2="539" y1="396.3203" y2="396.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56" x="412" y="391.2544">Fire alert</text><!--MD5=[7a3f877340f37a1f22d2db40552ae056]
@startuml puml-architecture

box "IoT device" iot
participant "iot-fire-alert\nNodeMCU v2" as nodemcu
participant "PIR sensor" as pir
end box

participant "fire-alert-server" as fas
participant "Firebase Cloud\nMessaging" as fcm
participant "Android App" as app

activate fcm
app -> fcm : I need a token
fcm -> app : This is Your token
deactivate fcm

app -> fas : This is my token\n(HTTP protocol)

nodemcu -> pir : check sensor
pir -> nodemcu

nodemcu -> pir : check sensor
pir -> nodemcu
deactivate pir

nodemcu -> fas : "I detected movement"\n(UDP protocol)

fas -> fcm : Push "fire alert"\nnotification\n(using token) 
fcm -> app : Fire alert

@enduml

PlantUML version 1.2022.13(Sat Nov 19 14:22:17 CET 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>